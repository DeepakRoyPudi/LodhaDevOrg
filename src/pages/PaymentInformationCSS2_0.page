<!-- VisualForce page for Payment Information tab CSS
    @Created by: Trupti Dhoka 
    @Created Date: 04/03/2015
     
    -------------------------------------------------------------------------------------
    | Modified By      | Modified Date       | Version        | Description         |
    ---------------------------------------------------------------------------------
    |Trupti Dhoka       18/03/2015                1.1            Updated UI 
    --------------------------------------------------------------------------------------
    |Trupti Dhoka       23/03/2015                1.2            updated pagination logic
    --------------------------------------------------------------------------------------
    |Trupti Dhoka       15/06/2015                1.3            enhancement of detail view
    ---------------------------------------------------------------------------------------------
    |Trupti Dhoka       06/07/2015                1.4            interest on all outstanding slabs 
                                                                 by entering a date. 
    ---------------------------------------------------------------------------------------------
    |Shruti Nikam       15/12/2015                1.5            Sorting based on due date  
    -->
<apex:page controller="PaymentInformationCSS2_0Controller" docType="html-5.0" 
    showHeader="false" title="Payment Information">
    <apex:composition template="LandingPageCSS2_0">
        <apex:define name="body">
            <!--           <apex:form > -->
            <head>
                <style>
                    body {
                    background-image: url({!IF(isProjectWise,imageUrl,
                    ($Resource.CSS_Background_Image))});
                    background-position: center center;
                    background-repeat: no-repeat;
                    background-attachment: fixed;
                    background-size: cover;
                    }
                    .link_style{
                    text-decoration: underline;
                    background : #fff !important;
                    }
                    .nav > li {
                    text-transform: none; !important;
                    }
                    .indicator_section{
                    height: 30px;
                    width: 80%;
                    margin: 1% 1% 1% 16%;
                    }
                    .indicator_div{
                    height: 18px;
                    width: 17%;
                    margin: 1%;
                    float: left;
                    margin-right: 4%;
                    }
                    .indicator_label{
                    float: left;
                    margin-top: 3px;
                    width: 23%;
                    }
                    @media (min-width: 100px) and (max-width:1199px) 
                    { 
                    .indicator_label {
                    float: left;
                    margin-top: 3px;
                    width: 119%;
                    margin-right: 30%;
                    margin-left: 0px;}
                    }
                    }
                    @media (max-width:767px) 
                    { 
                    .nav-tabs>li{
                    float:none;
                    }
                    }
                    <!-- this media query is used for showing aligned tabs in payment detail view-->
                    .Loyaltyheader{
                    text-align: center !important;
                    background-color: #A68D2B !important;
                    white-space: pre-wrap; /* css-3 */
                    white-space: pre-line; /* Mozilla, since 1999 */
                    white-space: -pre-wrap; /* Opera 4-6 */
                    white-space: -o-pre-wrap; /* Opera 7 */
                    word-wrap: break-word; /* Internet Explorer 5.5+ */
                    padding:0px !important;
                    border: #000 solid 1px;
                    color: #fff;
                    line-height: 1 !important;
                    font-size:13px;
                    vertical-align: middle !important;
                    }
                    .table>thead>tr>th, .table>tbody>tr>th, .table>tfoot>tr>th, 
                    .table>thead>tr>td, .table>tbody>tr>td, .table>tfoot>tr>td{
                    padding: 4px 2px; 
                    font-size: 12px;
                    }
                    .dataTables_wrapper .dataTables_paginate .paginate_button{  
                    padding: 0.2em 0.4em;
                    }
                    .tableborderImportant{
                    box-sizing: border-box !important;
                    }
                    .dataTables_filter{display:none }
                    .table-heading {
                    background-color: #A68D2B !important;
                    color: #FFF;
                    }
                    .modal{  
                    -webkit-box-sizing: border-box;  
                    -moz-box-sizing: border-box;  
                    box-sizing: border-box;  
                    max-height: 100%;  
                    width:100%;  
                    overflow:hidden;
                    }  
                    .modal-screen {
                    position: fixed;
                    overflow: hidden;
                    height: 100%;
                    }
                    h5{
                    font-weight: bold;
                    }
                    .dataTables_length{
                    margin-top:1%;
                    }
                    .black_overlay{
                    display: none;
                    position: absolute;
                    top: 13%;
                    left: 0%;
                    width: 96%;
                    height: 70%;
                    z-index:1001;
                    -moz-opacity: 0.8;
                    opacity:.80;
                    filter: alpha(opacity=80);
                    }
                    .white_content {
                    display: none;
                    position: fixed;
                    top: 25%;
                    left: 59%;
                    width: 32%;
                    height: 50%;
                    padding: 16px;
                    background-color: white;
                    border-radius: 3%;
                    box-shadow: 5px 5px 8px 8px #CCC;
                    z-index: 1002;
                    overflow: auto;
                    }
                    /*Media Query for virtual intrest calculator alignment*/
                    @media screen and (min-width: 50px) and (max-width: 991px) { 
                    .white_content {
                    display: none;
                    position: absolute;
                    height: 85%;
                    top: 60%;
                    left: 4%;
                    width: 90%;
                    padding: 16px;
                    background-color: white;
                    border-radius: 3%;
                    box-shadow: 5px 5px 8px 8px #CCC;
                    z-index: 1002;
                    overflow: auto;
                    }
                    
                    } 
                    .nav-tabs>li{
                    color:#666!important;
                    border-bottom: 1px solid #fff !important;
                    margin-top: 1%;
                    margin-left: 1%;
                    margin-right: 0% !important;
                    }
                    .nav-tabs>li>a{
                    border:none!important;   
                    outline: none!important;
                    line-height: 13px; 
                    }
                    <!--below css are used for changing font and background color for tab headers -->
                    .nav>li>a:hover, .nav>li>a:focus {
                    background-color: #fff!important;
                    color:#a68d2b!important;
                    } 
                    .nav-tabs>li.active>a, .nav-tabs>li.active>a:hover, .nav-tabs>li.active>a:focus{  
                    color:#fff!important;
                    background-color:#a68d2b !important;
                    }
                    table tr td{ 
                    font-size:11px !IMPORTANT;
                    }
                    .dateFormat {
                    display:none;
                    } 
                    .datePicker{
                    z-index:9999999999999;
                    position: fixed;
                    }  
                     @media screen and (min-width: 50px) and (max-width: 991px) {
                    .acc-ledger {
                       margin-left:12%;
                    }
                    }
                </style>
            </head>
            <apex:outputPanel >
                <body>
                    <!-- Google Analtyics component -->
                    <c:GoogleAnalytics Page="Home" 
                        User="{!username}" 
                        Project="{!userProject}" 
                        Segment="{!userSeqment}" 
                        CRN="{!userCRN}"
                        Gender="male" 
                        LastLogin="{!userLastLogin}" />
                    <apex:form >
                        <apex:actionFunction name="doSomething" action="{!PaymentMode}"/>
                        <!-- Action functions for virtual cal  -->
                        <apex:actionFunction name="populateData" action="{!autoPopulateMyGainVar}" rerender="outputID,err"
                            status="Loading">
                            <apex:param name="dueDate" value="" />
                            <apex:param name="amt" value=""/>
                        </apex:actionFunction>
                        <apex:actionFunction name="clearVal" action="{!clearValues}" rerender="outputID,err">
                        </apex:actionFunction>
                        <apex:actionFunction name="clearVal_totalvirtualcal" action="{!totalvirtualcal_clearValues}" rerender="outputID1,err1">
                        </apex:actionFunction>
                    </apex:form>
                    <div class="container" style="margin-top:10px;padding: 20px;">
                        <div class="panel panel-default panelmargintop" style="margin-right:2%">
                            <div role="tabpanel">
                                <!-- Nav tabs -->
                                <ul class="nav nav-tabs nav-tabs" style="margin-left: -0.4%;">
                                    <li role="presentation" class="active">
                                        <a href="#Payments" aria-controls="home" 
                                            role="tab" data-toggle="tab">
                                        Payments Summary
                                        </a>
                                    </li>
                                    <li role="presentation">
                                        <a href="#schedule" aria-controls="messages" 
                                            role="tab" data-toggle="tab">
                                            Payments Schedule
                                        </a>
                                    </li>
                                    <li role="presentation" style="display:{!IF(tabEnableDisableSetting[0].DisableAccountLedgerTab__c,'none','block')}" >
                                            <a href="#account"  aria-controls="messages" 
                                                role="tab" data-toggle="tab">
                                                Account Ledger
                                            </a>
                                    </li>
                                    <!-- <li role="presentation">
                                        <a class="link_style" href="#" 
                                           data-toggle="modal" data-target="#mygain"  
                                           data-backdrop="static" data-keyboard="false">
                                            My-Gain Statement
                                         </a>
                                        </li>
                                        <li role="presentation">
                                        <a class="link_style" href="#" data-toggle="modal" 
                                           data-target="#loan"  data-backdrop="static" 
                                           data-keyboard="false">
                                            Loan Details
                                         </a>
                                        </li>-->
                                    <li role="presentation" style="border: #fff !important; ">
                                        <a class="link_style" href="#" onclick="doSomething();">
                                        Payment Modes &#38; Favoring Details
                                        </a>
                                    </li>
                                </ul>
                                <!-- Tab panes -->
                                <div class="tab-content" style="  margin-left: -2%;">
                                    <div role="tabpanel" class="tab-pane active" id="Payments" 
                                        style="overflow-x:auto;margin-left:1%;overflow-y:hidden;">
                                        <!-- Indicator section started -->
                                        
                                        <div class="indicator_section">
                                            <div class="indicator_label" >
                                                <div class="indicator_div" style="background-color:{!Milestones_Paid_obj.ColorCode__c}">
                                                </div>
                                                Milestones Paid
                                            </div>
                                            <div class="indicator_label">
                                                <div class="indicator_div" style="background-color:{!Milestones_Outstanding_obj.ColorCode__c}">
                                                </div>
                                                Milestones O/S
                                            </div>
                                            <div class="indicator_label" >
                                                <div class="indicator_div" style="background-color:{!Milestones_Upcoming_obj.ColorCode__c}">
                                                </div>
                                                Milestones Upcoming
                                            </div>
                                            <div class="indicator_label" style="width: 28%;"> 
                                                <button type="button" href = "javascript:void(0)" onclick = "document.getElementById('totalvirtual').style.display='block';document.getElementById('totalvirtualfade').style.display='block';" 
                                                    style="margin-right: 2%; margin-top: -1%;" reRender="outputID1">
                                                    <img src="{!URLFOR($Resource.Bootstrap, '/bootstrap/images/Calculator.png')}" style="width:18px; float:Left;height: 16px;"/>
                                                    <apex:outputLabel style="display: inline;" value="Total Virtual Interest Calculator"/>
                                                </button>
                                            </div>
                                            
                                            <!--<button type="button" href = "javascript:void(0)" onclick = "document.getElementById('totalvirtual').style.display='block';document.getElementById('totalvirtualfade').style.display='block';" style="float: right;margin-right: 2%; margin-top: -26px; height: 23px;" reRender="outputID1"> 
                                               <img src="{!URLFOR($Resource.Bootstrap, '/bootstrap/images/Calculator.png')}" style="width:18px; float:Left;height: 16px;"/>
                                              <apex:outputLabel value="Total Virtual Interest Calculator"/>
                                            </button> -->
                                        </div>
                                     
                                        
                                        <div id="totalvirtualfade" class="black_overlay"></div>
                                        <div class="table-responsive">
                                            <apex:form >
                                                <table id="outstandingtableRM" 
                                                    class="table table-striped table-bordered">
                                                    <thead>
                                                        <tr>
                                                            <th class="sorting  table-heading">
                                                                Milestone 
                                                            </th>
                                                            <th class="sorting table-heading">
                                                                Due Date
                                                            </th>
                                                            <th class="sorting table-heading">
                                                                Payment Received Date
                                                            </th>
                                                            <th class="sorting table-heading">
                                                                Demand Amount {!$Label.Currency_INR_notation_RM_CSS}
                                                            </th>
                                                            <th class="sorting table-heading">
                                                                Amount Received {!$Label.Currency_INR_notation_RM_CSS}
                                                            </th>
                                                            <th class="sorting table-heading">
                                                                Balance Due {!$Label.Currency_INR_notation_RM_CSS}
                                                            </th>
                                                            <th class="sorting table-heading">
                                                                Overdue Status {!$Label.Currency_INR_notation_RM_CSS}
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <apex:repeat value="{!listDemandWrapper}" var="PaymentURW">
                                                            <tr>
                                                                <td style="background-color:{!PaymentURW.background_color}">
                                                                    <apex:outputText value="{!PaymentURW.Payment_Milestone_Formula}"/>
                                                                </td>
                                                                <td style="background-color:{!PaymentURW.background_color}">
                                                                    <c:FormatDateColumnComponent date_value="{!PaymentURW.Due_Date}" html-style="display:none;"/>
                                                                    <c:FormatDateComponent date_value="{!PaymentURW.Due_Date}" />
                                                                </td>
                                                                <td style="background-color:{!PaymentURW.background_color}">
                                                                    <!--Hide date value coming from FormatDateColumnComponent 
                                                                        but sort according to hidden values and show date in dd MMM yyyy format
                                                                        FormatDateComponent-->
                                                                    <c:FormatDateColumnComponent date_value="{!PaymentURW.Payment_received_on}" html-style="display:none;"/>
                                                                    <c:FormatDateComponent date_value="{!PaymentURW.Payment_received_on}"/>
                                                                </td>
                                                                <td style="background-color:{!PaymentURW.background_color}">
                                                                    <c:FormatCurrencyComponent currency_value="{!PaymentURW.Demand_amount}"/>
                                                                    <!--                                                     <apex:outputText value="{0, number,##,##,##,###.00}"> -->
                                                                    <!--                                                          <apex:param value="{!PaymentURW.Demand_amount}"/> -->
                                                                    <!--                                                    </apex:outputtext> -->
                                                                </td>
                                                                <td style="background-color:{!PaymentURW.background_color}">
                                                                    <c:FormatCurrencyComponent currency_value="{!PaymentURW.Amount_received}"/>
                                                                    <!--                                                    <apex:outputText value="{0, number,##,##,##,###.00}"> -->
                                                                    <!--                                                         <apex:param value="{!PaymentURW.Amount_received}"/> -->
                                                                    <!--                                                    </apex:outputtext> -->
                                                                </td>
                                                                <td style="background-color:{!PaymentURW.background_color}">
                                                                    <c:FormatCurrencyComponent currency_value="{!PaymentURW.Balance_Due}"/>
                                                                    <!--                                                      <apex:outputText value="{0, number,##,##,##,###.00}"> -->
                                                                    <!--                                                         <apex:param value="{!PaymentURW.Balance_Due}"/> -->
                                                                    <!--                                                    </apex:outputtext> -->
                                                                    <apex:outputPanel rendered="{!AND(PaymentURW.Balance_Due > 0)}">
                                                                        <a href = "javascript:void(0)" onclick = "document.getElementById('light').style.display='block';document.getElementById('fade').style.display='block'; populateData('{!PaymentURW.Due_Date}', '{!PaymentURW.Balance_Due}'); document.getElementById('dateinput').value=' '" reRender="outputID"> 
                                                                        <img src="{!URLFOR($Resource.Bootstrap, '/bootstrap/images/Calculator.png')}" 
                                                                            style="height:18px; width:18px; float:right"/></a>
                                                                    </apex:outputPanel>
                                                                </td>
                                                                <td style="background-color:{!PaymentURW.background_color}">
                                                                    <apex:outputText value="{!PaymentURW.Overdue_Status}" 
                                                                        escape="false"/>
                                                                </td>
                                                            </tr>
                                                        </apex:repeat>
                                                    </tbody>
                                                </table>
                                            </apex:form>
                                        </div>
                                        <h3>
                                            <apex:outputLabel style="padding:3% 0% 1% 0%;" value="Service Tax"/>
                                        </h3>
                                        <div class="table-responsive">
                                            <table class="table table-striped table-bordered">
                                                <thead>
                                                    <tr>
                                                        <th class="table-heading">
                                                            Taxable Amnt-Const Service
                                                        </th>
                                                        <th class=" table-heading">
                                                            Taxable Amnt-Pref Loc.
                                                        </th>
                                                        <th class="sorting table-heading">
                                                            Total Taxable Amnt
                                                        </th>
                                                        <th class="sorting table-heading">
                                                            ST on Const. Serv.
                                                        </th>
                                                        <th class="sorting table-heading">
                                                            ST on Pref. Loc.
                                                        </th>
                                                        <th class="sorting table-heading">
                                                            Total ST Payable
                                                        </th>
                                                        <th class="sorting table-heading">
                                                            Payment Received
                                                        </th>
                                                        <th class="sorting table-heading">
                                                            Balance due
                                                        </th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <apex:repeat value="{!serviceTaxList}" var="STList">
                                                        <tr>
                                                            <td>
                                                                <apex:outputField value="{!STList.Const_Service_tax_Amount__c}"/>
                                                            </td>
                                                            <td>
                                                                <apex:outputField value="{!STList.Pref_location_Service_Tax__c}"/>
                                                            </td>
                                                            <td>
                                                                <apex:outputField value="{!STList.Taxable_Service_Tax_Amount__c}"/>
                                                            </td>
                                                            <td>
                                                                <apex:outputField value="{!STList.ST_on_Construction_Serv__c}"/>
                                                            </td>
                                                            <td>
                                                                <apex:outputField value="{!STList.ST_on_Preferential_Location__c}"/>
                                                            </td>
                                                            <td>
                                                                <apex:outputField value="{!STList.Total_ST_Payable__c}"/>
                                                            </td>
                                                            <td>
                                                                <apex:outputField value="{!STList.Payment_Received__c}"/>
                                                            </td>
                                                            <td>
                                                                <apex:outputField value="{!STList.Balance_due__c}"/>
                                                            </td>
                                                        </tr>
                                                    </apex:repeat>
                                                    <tr style="{!If(serviceTaxList.size > 0, 'display:none','' )}">
                                                        <td valign="top" colspan="7" class="dataTables_empty" style="text-align: center !important;">No data available in table</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <!-- Disclaimer for page>-->
                                        <apex:outputLabel style="padding:3% 0% 1% 0%" value="{!$Label.CSS2_0_Disclaimer}"/>
                                        <!-- End of Disclaimer--> 
                                        <div id="totalvirtual" class="white_content" style="" >
                                            <a href = "javascript:void(0)" type="button"  onclick = "document.getElementById('totalvirtual').style.display='none';document.getElementById('totalvirtualfade').style.display='none'; clearVal_totalvirtualcal();" style=" font-size: 20px; float: right;" >&times;</a>
                                            <div style=" height:20%; width:100%">
                                                <h4 class="modal-title" id="myModalLabel">
                                                    Total Virtual Interest Calculator
                                                    <apex:actionStatus id="Loading1" >
                                                        <apex:facet name="start">
                                                            <apex:image url="{!URLFOR($Resource.Bootstrap, '/bootstrap/images/loadimage.gif')}" 
                                                                height="25px" width="25px" />
                                                        </apex:facet>
                                                    </apex:actionStatus>
                                                </h4>
                                            </div>
                                            <apex:form >
                                                <div  style=" height:80%; width:100%">
                                                    <apex:outputPanel id="outputID1">
                                                        <div class="col-md-12">
                                                            <apex:outputText id="err1" value="{!errorMsg1}"  style="color:red;"/>
                                                            <div class="col-md-6">
                                                                <apex:outputLabel value="Date of Payment Received By Lodha " />
                                                            </div>
                                                            <div class="col-md-6">
                                                                <apex:inputField value="{!receiveddate.Despatch_Date__c}"/>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-12" style="margin-top :2%">
                                                            <div class="col-md-6">
                                                                <apex:outputLabel value="Total Outstanding Amount" />
                                                            </div>
                                                            <div  class="col-md-6">
                                                                INR&nbsp;
                                                                <c:FormatCurrencyComponent currency_value="{!Text(TotalAmtDue)}"/>
                                                                <!--<apex:outputText value="INR {!virtualInterest_obj.outstandingamt}"  style="margin-left: 10px;width: 40%;display:none"/>-->
                                                            </div>
                                                        </div>
                                                        <div style="display:block;height: 50px;">
                                                            <apex:commandButton value="Calculate" 
                                                                style="float:right;
                                                                padding: 3px 10px 3px 10px;
                                                                margin-right: 41%;" 
                                                                status="Loading1"
                                                                styleclass="btn"
                                                                action="{!calculateTotal_VirtualInterest}"   
                                                                reRender="outputID1,err1"/>
                                                        </div>
                                                        <div class="col-md-12" style="margin-top :2%">
                                                            <div class="col-md-6">
                                                                <apex:outputLabel value="Total Virtual Interest Amount"
                                                                    rendered="{!showtotalamt}" />
                                                            </div>
                                                            <div class="col-md-6">
                                                                <apex:outputpanel rendered="{!showtotalamt}">
                                                                    INR &nbsp;
                                                                    <c:FormatCurrencyComponent currency_value="{!total_virtual_interest_obj.totalamt}"/>
                                                                </apex:outputpanel>
                                                            </div>
                                                        </div>
                                                    </apex:outputPanel>
                                                </div>
                                            </apex:form>
                                        </div>
                                        <div id="totalvirtualfade" class="black_overlay"></div>
                                    </div>
                                    <div role="tabpanel" class="tab-pane" id="schedule" style="margin-left: 2%;">
                                        <div class="table-responsive">
                                            <table id="scheduletableRM" class="table table-striped table-bordered" style="width:70%;">
                                                <thead>
                                                    <tr>
                                                        <th class=" table-heading" style="width:6%;" >
                                                            Sr. No
                                                        </th>
                                                        <th class=" table-heading" style="width:40%;">
                                                            Milestone 
                                                        </th>
                                                        <th class=" table-heading">
                                                            Amount as % of CV
                                                        </th>
                                                        <th class=" table-heading"> 
                                                            Amount Due* {!$Label.Currency_INR_notation_RM_CSS}
                                                        </th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <apex:repeat value="{!restApiPaymentSchedule.paymentScheduleWrapperList}" 
                                                        var="Payment">
                                                        <tr>
                                                            <td>
                                                                <apex:outputText value="{!Payment.Sr_no}"/>
                                                            </td>
                                                            <td>
                                                                <apex:outputText value="{!Payment.Payment_Milestone}"/>
                                                            </td>
                                                            <td>
                                                                <apex:outputText value="{!Payment.percentOfCV}%" 
                                                                    rendered="{!(Payment.percentOfCV!=null)}"/>
                                                            </td>
                                                            <td>
                                                                <c:FormatCurrencyComponent currency_value="{!Payment.Principal_Amount}"/>
                                                            </td>
                                                        </tr>
                                                    </apex:repeat>
                                                    <tr style="{!If(restApiPaymentSchedule.paymentScheduleWrapperList.size > 0, 'display:none','' )}">
                                                        <td valign="top" colspan="7" class="dataTables_empty" style="text-align: center !important;">No data available in table</td>
                                                    </tr>
                                                    <tr>
                                                        <th>
                                                        </th>
                                                        <th>
                                                        </th>
                                                        <th>
                                                            Total
                                                        </th>
                                                        <th>
                                                            <apex:outputText value="{!restApiPaymentSchedule.totalAmount}"/>
                                                        </th>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <p style="margin-top: 1%;">*Service tax as applicable at the time of billing/raising of slab will be applicable on the amount due, as levied by the government.</p>
                                    </div>
                                    <div role="tabpanel" class="tab-pane" id="account" style="margin-left: 2%;">
                                        <div class="table-responsive">
                                            <table id="accountLedger" class="table table-striped table-bordered">
                                                <thead>
                                                    <tr>
                                                        <th class="sorting table-heading">
                                                            Instrument No.
                                                        </th>
                                                        <th class="sorting table-heading">
                                                            Instrument Date
                                                        </th>
                                                        <th class="sorting table-heading">
                                                            Instrument Received Date
                                                        </th>
                                                        <th class="sorting table-heading">
                                                            Customer Bank Name
                                                        </th>
                                                        <th class="sorting table-heading">
                                                            Amount {!$Label.Currency_INR_notation_RM_CSS}
                                                        </th>
                                                        <th class="sorting table-heading">
                                                            Milestone
                                                        </th>
                                                        <th class="sorting table-heading">
                                                            Receipt No.
                                                        </th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <apex:repeat value="{!restAPICalloutPayment.AccountLedgerList}" 
                                                        var="AccLeg">
                                                        <tr>
                                                            <td >
                                                                <apex:outputText value="{!AccLeg.reference}"/>
                                                            </td>
                                                            <td >
                                                                <apex:outputText value="{!AccLeg.Instrument_Date}"/>
                                                            </td>
                                                            <td >
                                                                <apex:outputText value="{!AccLeg.received_date}"/>
                                                            </td>
                                                            <td >
                                                                <apex:outputText value="{!AccLeg.bank_details}"/>
                                                            </td>
                                                            <td >
                                                                <c:FormatCurrencyComponent currency_value="{!AccLeg.principal_amount_received}"/>
                                                            </td>
                                                            <td >
                                                                <apex:outputText value="{!AccLeg.payment_mileStone}"/>
                                                            </td>
                                                            <td >
                                                                <apex:outputText value="{!AccLeg.receipt_no}"/>
                                                            </td>
                                                        </tr>
                                                    </apex:repeat>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                    <!--                                Virtual Intrest Cal -->
                                    <div id="light" class="white_content">
                                        <a href = "javascript:void(0)" onclick = "document.getElementById('light').style.display='none';document.getElementById('fade').style.display='none'" style=" font-size: 20px; float: right;">&times;</a>
                                        <div style=" height:15%; width:100%">
                                            <h4 class="modal-title" id="myModalLabel">
                                                Virtual Interest Calculator
                                                <apex:actionStatus id="Loading" >
                                                    <apex:facet name="start">
                                                        <apex:image url="{!URLFOR($Resource.Bootstrap, '/bootstrap/images/loadimage.gif')}" 
                                                            height="25px" width="25px"/>
                                                    </apex:facet>
                                                </apex:actionStatus>
                                            </h4>
                                        </div>
                                        <apex:form >
                                            <div style=" height:80%; width:100%">
                                                <apex:outputPanel id="outputID">
                                                    <div class="col-md-12">
                                                        <apex:outputText id="err" value="{!errorMsg}"  style="color:red;"/>
                                                    </div>
                                                    <br/>
                                                    <div class="col-md-12" style="margin-top :2%">
                                                        <div class="col-md-5">
                                                            <apex:outputLabel value="Due Date"/>
                                                        </div>
                                                        <div class="col-md-7">
                                                            <apex:outputText value="{0, date, dd/MM/yyyy}" >
                                                                <apex:param value="{!virtualInterest_obj.duedate}" />
                                                            </apex:outputText>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-12" style="margin-top :2%">
                                                        <div class="col-md-5">
                                                            <apex:outputLabel value="Date of Payment Received By Lodha " />
                                                        </div>
                                                        <div class="col-md-7">
                                                            <apex:inputField value="{!acc.Despatch_Date__c}" id="dateinput"/>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-12" style="margin-top :2%">
                                                        <div class="col-md-5">
                                                            <apex:outputLabel value="Outstanding Amount" />
                                                        </div>
                                                        <div class="col-md-7">
                                                            <!-- <apex:outputText value="INR {!virtualInterest_obj.outstandingamt}"  style="margin-left: 10px;width: 40%;"/>-->
                                                            INR &nbsp;
                                                            <c:FormatCurrencyComponent currency_value="{!Text(virtualInterest_obj.outstandingamt)}"/>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-4"></div>
                                                    <div class="col-md-4">
                                                        <apex:commandButton value="Calculate"
                                                            styleclass="btn buttoncolor "
                                                            status="Loading"
                                                            action="{!InterestAmount}"   
                                                            reRender="outputID,err"/>
                                                    </div>
                                                    <div class="col-md-4"></div>
                                                    <div class="col-md-12" style="margin-top :2%">
                                                        <div class="col-md-5">
                                                            <apex:outputLabel value="Total Virtual Interest Amount"
                                                                rendered="{!virtualInterest_obj.totalamt != null}" />
                                                        </div>
                                                        <div class="col-md-7">
                                                            <apex:outputpanel rendered="{!showamt}">
                                                                INR &nbsp;
                                                                <c:FormatCurrencyComponent currency_value=" {!virtualInterest_obj.totalamt} " />
                                                            </apex:outputpanel>
                                                        </div>
                                                    </div>
                                                </apex:outputPanel>
                                            </div>
                                        </apex:form>
                                    </div>
                                    <div id="fade" class="black_overlay"></div>
                                </div>
                            </div>
                            <!--<div class="modal fade"  id="mygain">
                                <div class="modal-dialog" style="width:100%;padding-top: 0px; 
                                     overflow: hidden;height: initial;">
                                   <div class="modal-content">
                                      <div class="modal-header">
                                         <button type="button" class="close" data-dismiss="modal" 
                                                 aria-label="Close">
                                             <span aria-hidden="true">
                                                 &times;
                                             </span></button>
                                         <h4 class="modal-title">My-Gain Statement</h4>
                                      </div>
                                      <div class="modal-body">
                                         <div >
                                            <h5>MyGain Details</h5>
                                            <div class="table-responsive">
                                               <table id="mygainD" 
                                                      class="table table-striped table-bordered tableborderImportant">
                                                  <thead>
                                                     <tr>
                                                        <th class="sorting Loyaltyheader">
                                                           Instrument Number
                                                        </th>
                                                        <th class="sorting Loyaltyheader">
                                                           Bank Details
                                                        </th>
                                                        <th class="sorting Loyaltyheader">
                                                           Instrument Date
                                                        </th>
                                                        <th class="sorting Loyaltyheader">
                                                           Instrument Received Date
                                                        </th>
                                                        <th class="sorting Loyaltyheader">
                                                           Instrument Posting Date
                                                        </th>
                                                        <th class="sorting Loyaltyheader">
                                                           Mygain Amount Received {!$Label.Currency_INR_notation_RM_CSS}
                                                        </th>
                                                        <th class="sorting Loyaltyheader">
                                                           Mygain Already Adjusted {!$Label.Currency_INR_notation_RM_CSS}
                                                        </th>
                                                        <th class="sorting Loyaltyheader">
                                                           Mygain Balance As On Date {!$Label.Currency_INR_notation_RM_CSS}
                                                        </th>
                                                        <th class="sorting Loyaltyheader">
                                                           Benefit From
                                                        </th>
                                                        <th class="sorting Loyaltyheader">
                                                           Benefit Till
                                                        </th>
                                                        <th class="sorting Loyaltyheader">
                                                           Benefit Days
                                                        </th>
                                                        <th class="sorting Loyaltyheader">
                                                           Rebate Calculated {!$Label.Currency_INR_notation_RM_CSS}
                                                        </th>
                                                        <th class="sorting Loyaltyheader">
                                                           Text
                                                        </th>
                                                        <th class="sorting Loyaltyheader">
                                                           Interest Rate
                                                        </th>
                                                     </tr>
                                                  </thead>
                                                  <tbody>
                                                     <apex:repeat value="{!rcMygain.MygaincompleteRecords}" var="myc">
                                                        <tr>
                                                           <td >
                                                              <apex:outputText value="{!myc.Instrument_Number}" />
                                                           </td>
                                                           <td >
                                                              <apex:outputText value="{!myc.Bank_Details}" />
                                                           </td>
                                                           <td >
                                                              <apex:outputText value="{!myc.Instrument_Date}"/>
                                                           </td>
                                                           <td >
                                                              <apex:outputText value="{!myc.Instrument_Receive_Date}"/>
                                                           </td>
                                                           <td >
                                                              <apex:outputText value="{!myc.Instrument_Posting_Date}"/>
                                                           </td>
                                                           <td>
                                                              <c:FormatCurrencyComponent currency_value="{!myc.My_Gain_Amt_Receive}"/>  
                                                           </td>
                                                           <td>
                                                              <c:FormatCurrencyComponent currency_value="{!myc.My_Gain_Already_Adjusted}"/>
                                                           </td>
                                                           <td>
                                                              <c:FormatCurrencyComponent currency_value="{!myc.My_Gain_Balance_as_on_Date}"/>
                                                           </td>
                                                           <td>
                                                              <apex:outputText value="{!myc.Benefit_From}"/>
                                                           </td>
                                                           <td>
                                                              <apex:outputText value="{!myc.Benefit_Till}"/>
                                                           </td>
                                                           <td>
                                                              <apex:outputText value="{!myc.Benefit_Days}"/>
                                                           </td>
                                                           <td >
                                                              <apex:outputText value="{!myc.Rebate_Calculated}" 
                                                                               rendered="{!AND(myc.Rebate_Calculated!=null,
                                                                                              myc.Rebate_Calculated!='') }"/>
                                                           </td>
                                                           <td >
                                                              <apex:outputText value="{!myc.Text}"/>
                                                           </td>
                                                           <td >
                                                              <apex:outputText value="{!myc.Intrest_Rate}%" 
                                                                               rendered="{!AND(myc.Intrest_Rate!=null,
                                                                                              myc.Intrest_Rate!='')}"/>
                                                           </td>
                                                        </tr>
                                                     </apex:repeat>
                                                  </tbody>
                                               </table>
                                            </div>
                                         </div>
                                         <div style="margin-top:2%">
                                            <h5>MyGain Rebate Details</h5>
                                            <div class="table-responsive">
                                               <table id="mygainR" class="table table-striped table-bordered tableborderImportant">
                                                  <thead>
                                                     <tr>
                                                        <th class="sorting table-heading">
                                                           Amount For Rebate Calculated {!$Label.Currency_INR_notation_RM_CSS}
                                                        </th>
                                                        <th class="sorting table-heading">
                                                           Rebate Posted {!$Label.Currency_INR_notation_RM_CSS}
                                                        </th>
                                                        <th class="sorting table-heading">
                                                           Rebate Calculated From
                                                        </th>
                                                        <th class="sorting table-heading">
                                                           Rebate Calculated Till
                                                        </th>
                                                        <th class="sorting table-heading">
                                                           Benefit Days
                                                        </th>
                                                     </tr>
                                                  </thead> 
                                                  <tbody>
                                                     <apex:repeat value="{!rcMygain.MygainBasicRecords}" var="myb">
                                                        <tr>
                                                           <td >
                                                              <c:FormatCurrencyComponent currency_value="{!myb.Amt_For_Rebate_Calculated}"/>
                                                           </td>
                                                           <td >
                                                              <c:FormatCurrencyComponent currency_value="{!myb.Rebate_Posted}"/>
                                                           </td>
                                                           <td >
                                                              <apex:outputText value="{!myb.Rebate_Calculated_From}"/>
                                                           </td>
                                                           <td >
                                                              <apex:outputText value="{!myb.Rebate_Calculated_Till}"/>
                                                           </td>
                                                           <td >
                                                              {!myb.Benefit_Days}
                                                           </td>
                                                        </tr>
                                                     </apex:repeat>
                                                  </tbody>
                                               </table>
                                            </div>
                                         </div>
                                      </div>
                                   </div>
                                   
                                </div>
                                
                                </div>
                                <div class="modal fade"  id="loan">
                                <div class="modal-dialog" style="width: 42%;margin-top: 14%;">
                                   <div class="modal-content">
                                      <div class="modal-body">
                                         <div style="background-color:#A68D2B;color:#fff;padding:4px;">
                                            <span class="fa fa-university  " style="color:#fff;"></span>
                                            <h5>Your Loan Details</h5>
                                            <button type="button" class="close" 
                                                    data-dismiss="modal" aria-label="Close">
                                             <span aria-hidden="true">&times;</span>
                                            </button>
                                         </div>
                                         <div class="table-responsive">
                                            <table class="table table-bordered" style=" 
                                                   font-size: 13px;background-color: white;">
                                               <thead>
                                                  <tr>
                                                     <th>Name
                                                     </th>
                                                     <th>Amount Sanctioned {!$Label.Currency_INR_notation_RM_CSS}
                                                     </th>
                                                     <th>%CV
                                                     </th>
                                                     <th>Sanctioned Date
                                                     </th>
                                                  </tr>
                                               </thead>
                                               <tbody>
                                                  <tr>
                                                     <td>
                                                        <apex:outputText value="{!RestAPICallout_wrapper_obj.bank_name}"/>
                                                     </td>
                                                     <td>-->
                            <!--<apex:outputText value="INR {!RestAPICallout_wrapper_obj.amount_sanctioned}" rendered="{!AND(RestAPICallout_wrapper_obj.amount_sanctioned!=null, RestAPICallout_wrapper_obj.amount_sanctioned!=' ')}"/>-->
                            <!--<c:FormatCurrencyComponent currency_value="{!RestAPICallout_wrapper_obj.amount_sanctioned}"/>
                                </td>
                                <td>
                                   <apex:outputText value="{!RestAPICallout_wrapper_obj.cv_sanctioned}"/>
                                </td>
                                <td>
                                   <apex:outputText value="{!RestAPICallout_wrapper_obj.sanctioned_date}"/>
                                </td>
                                </tr>
                                </tbody>
                                </table>
                                </div>
                                </div>
                                </div>
                                
                                </div>
                                
                                </div>-->
                            <div id="fade" class="black_overlay"></div>
                            <script type="text/javascript" >
                                $(document).ready(function() {
                                    $('#outstandingtableRM').dataTable( {
                                    "order": [[ 1, "asc" ]],
                                     "iDisplayLength": 50
                                    } );
                                    
                                    $('#accountLedger').dataTable( {
                                    "order": [[ 0, "asc" ]],
                                     "iDisplayLength": 50
                                    } );
                                    $('#mygainD').dataTable( {
                                    "order": [[ 0, "desc" ]],
                                     "iDisplayLength": 50
                                    } );
                                    $('#mygainR').dataTable( {
                                    "order": [[ 0, "desc" ]],
                                     "iDisplayLength": 50
                                    } );
                                    
                                } );
                                
                            </script> 
                        </div>
                        <!--End of panel panel defalut-->
                    </div>
                    <!-- End of Container -->
                    <div class="foorterdiv"></div>
                </body>
            </apex:outputPanel>
            <!--          </apex:form> -->
        </apex:define>
    </apex:composition>
</apex:page>